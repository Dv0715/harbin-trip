<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>æ—…è¡Œå›æ†¶ï½œå“ˆçˆ¾æ¿±</title>

  <style>
    :root {
      /* âœ… åˆ‡æ›ç‚ºæ·±è‰²èª¿è¨ˆç•« */
      --bg: #0a0c12;
      --text: #f5f5f7;
      --muted: #86868b;
      --line: rgba(255, 255, 255, 0.1);

      /* âœ… ç»ç’ƒæ“¬æ…‹å¡ç‰‡ï¼šæ·±è‰²åŠé€æ˜ */
      --card: rgba(28, 28, 32, 0.8);
      --card-border: rgba(255, 255, 255, 0.1);
      --shadow: 0 20px 40px rgba(0,0,0,0.5);
      --radius: 28px;
      --accent: #eed66e;

      /* chips */
      --chipBg: rgba(255, 255, 255, 0.05);
      --chipBorder: rgba(255, 255, 255, 0.1);

      /* stage */
      --stageBorder: rgba(255, 255, 255, 0.15);

      /* çœ‹ç›¸ç°¿ç¸½è¦½æŒ‰éˆ•ç™¼å…‰ */
      --accent-glow: rgba(14, 88, 226, 0.8); 
    }

    * { box-sizing: border-box; -webkit-font-smoothing: antialiased; }
    body {
      margin: 0;
      font-family: "SF Pro Display","SF Pro Icons","Helvetica Neue","Helvetica","Arial","Noto Sans TC",sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      overflow-x: hidden;
    }

    /* --- Snow Canvas --- */
    #snowCanvas {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: 50;
      pointer-events: none;
    }

    .app-wrap {
      position: relative;
      z-index: 10;
    }

    /* Topbar */
    .topbar {
      position: sticky; top: 0; z-index: 100;
      background: rgba(10, 12, 18, 0.75);
      backdrop-filter: saturate(180%) blur(20px);
      -webkit-backdrop-filter: saturate(180%) blur(20px);
      border-bottom: 1px solid var(--line);
    }
    .topbar-inner {
      max-width: 900px; margin: 0 auto; padding: 18px 24px;
      display: flex; justify-content: space-between; align-items: center; gap: 14px;
    }
    .brand h1 { margin: 0; font-size: 18px; font-weight: 700; letter-spacing: -0.4px; }
    .brand .meta { font-size: 12px; color: var(--muted); font-weight: 500; margin-top: 2px; }
    .pill {
      background: #fff; color: #000;
      padding: 6px 14px; border-radius: 999px;
      font-size: 11px; font-weight: 600; letter-spacing: 0.5px; white-space: nowrap;
    }

    .wrap {
      max-width: 900px; margin: 0 auto;
      padding: 32px 20px 100px;
      display: flex; flex-direction: column; gap: 28px;
    }

    /* Intro */
    .intro {
      background: var(--card);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid var(--card-border);
      padding: 32px;
      display: flex; gap: 24px; align-items: center;
    }
    .avatar {
      width: 56px; height: 56px; border-radius: 999px;
      background: linear-gradient(135deg, #0071e3, #40a9ff);
      flex-shrink: 0;
      box-shadow: 0 8px 16px rgba(0,113,227, 0.3);
    }
    .intro h2 { margin: 0; font-size: 22px; font-weight: 800; letter-spacing: -0.5px; }
    .intro p { margin: 6px 0 0; font-size: 15px; color: var(--muted); }


    /* Map Card */
    .map-card {
      background: var(--card);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid var(--card-border);
      overflow: hidden;
      padding-bottom: 20px;
    }
    
    .map-head {
      padding: 28px 28px 18px;
      display: flex; align-items: flex-start; justify-content: space-between; gap: 16px;
    }
    .map-head-left .t { margin: 0; font-size: 19px; font-weight: 800; letter-spacing: -0.2px; }
    .map-head-left .s { margin-top: 4px; font-size: 13px; color: var(--muted); }

    .map-chips {
      display: flex; gap: 10px; flex-wrap: wrap; justify-content: flex-end; align-items: center;
    }
    .chip {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 12px; border-radius: 999px;
      background: var(--chipBg);
      border: 1px solid var(--chipBorder);
      color: var(--text);
      font-size: 12px; font-weight: 600; text-decoration: none; white-space: nowrap;
      transition: all .2s;
    }
    .chip:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.2);
      transform: translateY(-1px);
    }

/* ğŸŸ¢ è§£æ±ºé»æ“Šé»‘æ¡†ï¼šç§»é™¤æ‰‹æ©Ÿç«¯é«˜äº® */
.pin, .day-chip, .snowman-btn, .chibi-char {
    -webkit-tap-highlight-color: transparent !important;
    outline: none !important;
}




/* é›ªäººæŒ‰éˆ• */
.snowman-btn span {
    display: inline-block;
    box-shadow: 0 0 8px rgba(0, 122, 255, 0.6); /* å¢åŠ è—è‰²ç™¼å…‰ */
    animation: label-pulse 1.5s infinite ease-in-out; /* è®“æ–‡å­—æ¨™ç±¤ä¹Ÿæœƒè·³å‹• */
    text-shadow: 0 1px 2px rgba(0,0,0,0.3);
}

@keyframes label-pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}




    /* âœ… å¼·åŒ–å¾Œçš„ã€Œçœ‹ç›¸ç°¿ç¸½è¦½ã€æŒ‰éˆ• */
    .album-cta {
      position: relative; /* ç‚ºäº†å…§å±¤æƒå…‰æ•ˆæœ */
      display: inline-flex; align-items: center; gap: 8px;
      padding: 12px 24px; border-radius: 999px;
      background: linear-gradient(135deg, #007aff 0%, #0051d7 100%);
      color: #fff;
      font-size: 18px; font-weight: 600; text-decoration: none;
      /* å¤šå±¤å¤–ç™¼å…‰æ•ˆæœ */
      box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.3),
        0 0 1px 0.05px var(--accent-glow),
        0 0 15px   rgba(9, 11, 77, 0.5);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      overflow: hidden; /* éš±è—æµå‡ºçš„æƒå…‰ */
      animation: glowPulse 1s infinite alternate; /* å‘¼å¸ç‡ˆæ•ˆæœ */
    }

    .album-cta::after {
      content: "";
      position: absolute;
      top: -50%; left: -100%; width: 60%; height: 200%;
      background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: rotate(30deg);
      animation: shine 4s infinite;
    }
    .album-cta:hover { 
      transform: translateY(-2px) scale(1.03); 
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4), 0 0 25px var(--accent-glow), 0 0 45px rgba(0,122,255,0.4);
      filter: brightness(1.1);
    }


/* 1. åŸæœ¬å…¨åŸŸçš„å‘¼å¸å‹•ç•« (ä¸ç”¨å‹•) */
@keyframes chibi-breath {
    0%, 100% { transform: translateX(-50%) scale(0.14, 0.14); }
    50% { transform: translateX(-50%) scale(0.142, 0.137); }
}

/* 1. æ‰‹æ©Ÿç‰ˆå°ˆå±¬å‘¼å¸å‹•ç•«å®šç¾© */
@keyframes chibi-breath-mobile {
    0%, 100% { transform: translateX(-50%) scale(0.12, 0.12); }
    50% { transform: translateX(-50%) scale(0.122, 0.117); }
}

    @keyframes glowPulse {
      from { box-shadow: 0 4px 15px rgba(0,0,0,0.3), 0 0 10px var(--accent-glow); }
      to { box-shadow: 0 4px 15px rgba(0,0,0,0.3), 0 0 25px var(--accent-glow), 0 0 40px rgba(0,122,255,0.3); }
    }
    @keyframes shine {
      0% { left: -100%; }
      20% { left: 150%; }
      100% { left: 150%; }
    }

    /* Stage */
    .map-stage {
      position: relative;
      width: calc(100% - 24px);
      margin: 0 12px 14px;
      aspect-ratio: 1368 / 810;
      border-radius: 18px;
      overflow: hidden;
      background: #706f6f;
      border: 1px solid var(--stageBorder);
      box-shadow: 0 18px 40px rgba(0,0,0,0.3);
    }
    .map-stage img {
      width: 100%; height: 100%;
      object-fit: cover; display: block;
      opacity: 0.75;
      filter: contrast(1.05) brightness(0.9);
    }
    .map-hint {
      position: absolute; right: 18px; bottom: 18px;
      padding: 10px 12px; border-radius: 999px;
      background: rgba(0,0,0,0.6);
      border: 1px solid rgba(255,255,255,0.15);
      color: rgba(255,255,255,0.8);
      font-size: 12px; backdrop-filter: blur(10px);
      user-select: none; pointer-events: none;
    }

    /* Pins & Anchors (å®Œå…¨ä¿ç•™åŸæœ¬ä½ç½®é‚è¼¯) */
/* 1. å¤–å±¤ï¼šå°ˆå¿ƒå‘¼å¸ï¼Œä¸æ”¾ transition */
.pin {
    position: absolute;
    transform: translate(-50%, -50%);
    z-index: 100;
    
    /* ğŸŸ¢ å°ˆæ¥­æ›¿ä»£æ–¹æ¡ˆï¼šæ˜ç¢ºå‘ŠçŸ¥ç€è¦½å™¨é€™äº›å±¬æ€§æœƒè®Šå‹• */
    will-change: transform, opacity;
    
    /* ğŸŸ¢ å¼·åˆ¶å•Ÿå‹• GPU åŠ é€Ÿ */
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;

    /* å‘¼å¸å‹•ç•« */
    animation: pin-float-smooth 3s infinite ease-in-out;
    
    /* ğŸ”´ ç‚ºäº†é…åˆé»æ“Šå¾Œçš„è®Šæ·¡æ•ˆæœï¼Œå»ºè­°ä¿ç•™ opacity çš„éæ¸¡ */
    transition: opacity 0.4s ease; 
}
    
.pin:hover {
    z-index: 999 !important; /* ç¢ºä¿æ‡¸åœæ™‚åœ¨æœ€å‰é¢ */
}


/* 2. å…§å±¤ Thumb è² è²¬ã€Œæ”¾å¤§ã€èˆ‡ã€ŒæŒ‡å‘ã€ */
.pin-thumb {
    width: 64px; height: 64px; /* æ‰‹æ©Ÿç‰ˆå»ºè­°é©åº¦ç¸®å° */
    border-radius: 50%;
    border: 1.5px solid rgba(255, 255, 255, 0.6) !important;
    overflow: hidden;
    padding: 2px; /* è®“ç…§ç‰‡èˆ‡é‚Šæ¡†é–“ç•™å‡ºä¸€é»ç©ºéš™ï¼Œæ›´æœ‰å‘¼å¸æ„Ÿ */
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
    box-shadow: 
        0 8px 20px rgba(0, 0, 0, 0.5),
        0 0 10px rgba(132, 212, 255, 0.3); /* å†°è—è‰²å¾®å…‰ */
    backdrop-filter: blur(8px); /* å¼·åŒ–ç»ç’ƒæ„Ÿ */  
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    display: flex; align-items: center; justify-content: center;
}

    .pin-thumb img { 
      width: 100%; height: 100%; 
      object-fit: cover; 
      pointer-events: none;
      /* ç¨ç«‹å¢åŠ åœ–ç‰‡äº®åº¦ï¼ŒæŠµæ¶ˆè¦–è¦ºå£“æŠ‘æ„Ÿ */
      filter: brightness(1.1) contrast(1.1); 
    }
.pin:hover .pin-thumb {
    transform: scale(1.3); /* é€™æ¨£æ”¾å¤§å°±ä¸æœƒè·Ÿå‘¼å¸è¡çªäº† */
    border-color: var(--accent);
}
    .pin-label {
      position: absolute; left: 50%; top: 100%; margin-top: 10px;
      transform: translateX(-50%); padding: 7px 14px; border-radius: 14px;
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(0,0,0,0.1);
      color: #000; font-size: 12px; font-weight: 700;
      white-space: nowrap; pointer-events: none; opacity: 0;
      transition: opacity .18s ease, transform .18s ease;
    }
    .pin:hover .pin-label {
    opacity: 1;
    transform: translateX(-50%) translateY(-5px); /* æ¨™ç±¤è·Ÿè‘—å¾€ä¸Šç§»å‹• */
}
/* åŠ ä¸Šé€™å€‹ class ä¾› JS åˆ‡æ›ï¼ˆå¯é¸ï¼‰ */
.pin-focus .pin-thumb {
    border-color: var(--accent) !important;
    box-shadow: 0 0 30px var(--accent-glow) !important;
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}


/* ğŸ”´ çµ²æ»‘æ¼‚æµ®å‹•ç•«ï¼šä½¿ç”¨ translateY è€Œé margin */
@keyframes pin-float-smooth {
    0%, 100% { transform: translate(-50%, -50%) translateY(0); }
    50% { transform: translate(-50%, -50%) translateY(-10px); }
}



/* æŒ‡æ¨™åœ¨åœ°åœ–ä¸Šçš„å½±å­/å®šä½é» */
.pin-shadow {
    width: 12px;
    height: 4px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 50%;
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    /* å½±å­æœƒéš¨è‘—æŒ‡æ¨™æ¼‚æµ®è€Œç¸®æ”¾ */
    animation: shadow-scale 2s ease-in-out infinite;
}

@keyframes shadow-scale {
    0%, 100% { transform: translateX(-50%) scale(1); opacity: 0.3; }
    50% { transform: translateX(-50%) scale(0.6); opacity: 0.1; }
}


/* 4. éŒ¯é–‹ä¸åŒ Pin çš„å‘¼å¸ç¯€å¥ï¼Œçœ‹èµ·ä¾†æ›´è‡ªç„¶ */
.pin:nth-child(odd) { animation-delay: 0.5s; }
.pin:nth-child(even) { animation-delay: 1.2s; }

@keyframes pin-float-global {
    0%, 100% { margin-top: 0; }
    50% { margin-top: -8px; } /* è¼•å¾®ä½ç§» */
}















/* å¯æ„›æµ®å‹•æŒ‡æ¨™ */





    .pin:hover .pin-thumb {
      transform: scale(1.10) translateY(-5px);
      box-shadow: 0 20px 44px rgba(0,0,0,0.5);
      border-color: var(--accent);
    }
    .pin-label {
      position: absolute; left: 50%; top: 100%; margin-top: 10px;
      transform: translateX(-50%); padding: 7px 14px; border-radius: 14px;
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(0,0,0,0.1);
      color: #000; font-size: 12px; font-weight: 700;
      white-space: nowrap; pointer-events: none; opacity: 0;
      transition: opacity .18s ease, transform .18s ease;
    }
    .pin:hover .pin-label { opacity: 1; transform: translateX(-50%) translateY(3px); }

    .anchor {
      position: absolute; transform: translate(-50%, -100%);
      width: 20px; height: 20px; z-index: 30; cursor: pointer; opacity: 0.95;
      transition: transform .12s ease, filter .12s ease, opacity .12s ease;
      user-select: none; touch-action: manipulation;
    }
    .anchor:hover { transform: translate(-50%, -100%) scale(1.1); }
    .anchor svg { width: 20px; height: 20px; display: block; }
    .anchor .pin-head { fill: #7fc1ff; }
    .anchor .pin-head-stroke { stroke: rgba(255,255,255,0.85); }
    .anchor .pin-needle { fill: #eaf5ff; }
    .anchor .pin-needle-stroke { stroke: rgba(0,0,0,0.22); }

    /* Hot Sync */
    .pin.is-hot .pin-thumb { transform: scale(1.1) translateY(-5px); border-color: #ff9e30; }
    .pin.is-hot .pin-label { opacity: 1; }
    .anchor.is-hot .pin-head { fill: #ff9e30; }

    /* --- âœ… Video Dock (ä¿®æ­£æŒ‰éˆ•æ›è¡Œè™•) --- */
.video-preview-box {
    width: 70px !important;      /* ç¸®å°é è¦½æ¡† */
    aspect-ratio: 1;             /* æ”¹ç‚ºæ­£æ–¹å½¢ï¼Œçœ‹èµ·ä¾†åƒ CD å°é¢æˆ–ç¸®åœ– */
    border-radius: 12px;
    flex-shrink: 0;
}

    .video-dock {
      margin: 16px; border-radius: var(--radius-md);
      background: rgba(255, 255, 255, 0.06) !important;
      border: 1px solid var(--line);
      padding: 12px 16px !important;
      
      /* é—œéµè¨­å®š */
      display: flex; 
      flex-direction: row;     /* æ°´å¹³æ’åˆ— */
      align-items: center;     /* å‚ç›´å±…ä¸­ */
      justify-content: space-between; /* æ¨™é¡Œå·¦ã€æŒ‰éˆ•å³ */
      flex-wrap: nowrap;       /* å¼·åˆ¶ä¸æ›è¡Œ */
      gap: 12px !important;
    }
    
    .video-dock-title {
      flex: 1;                 /* æ¨™é¡Œä½”æ»¿å‰©é¤˜ç©ºé–“ */
      min-width: 0;            /* é…åˆå½ˆæ€§ä½ˆå±€é¿å…æº¢å‡º */
    }
    
    .video-dock-title .kicker { font-size: 11px; color: var(--accent); font-weight: 700; text-transform: uppercase; }
    .video-dock-title .name {
    font-size: 14px !important;  /* ç¨å¾®ç¸®å°å­—é«” */
}

    .video-dock-btn {
      flex-shrink: 0;          /* é˜²æ­¢æŒ‰éˆ•è¢«æ“ å£“ç¸®å° */
      border: none; background: #fff; color: #000;
      padding: 10px 20px; border-radius: 999px;
      font-size: 14px; font-weight: 600; cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;     /* æ–‡å­—ä¹Ÿä¸è¦æ›è¡Œ */
    }
    .video-dock-btn:hover { transform: scale(1.05); background: #f5f5f7; }

    /* Chapters */
    .chapters { margin: 0 18px 6px; border-top: 1px solid var(--line); padding: 14px 16px 18px; }
    .chapters h3 { margin: 0 0 10px; font-size: 14px; font-weight: 900; color: var(--muted); }
    .chapter-grid { display: grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap: 12px; }
    .chapter-card {
      display: flex; gap: 10px; align-items: center; padding: 12px;
      border-radius: 16px; text-decoration: none; color: var(--text);
      background: rgba(255, 255, 255, 0.03); border: 1px solid var(--card-border);
      transition: all .2s;
    }
    .chapter-card:hover { transform: translateY(-2px); background: rgba(255, 255, 255, 0.08); border-color: rgba(255,255,255,0.2); }
    .chapter-dot { width: 10px; height: 10px; border-radius: 50%; background: #0071e3; box-shadow: 0 0 10px 0.1px rgba(0, 113, 227, 0.836); }
    .chapter-title { font-size: 13px; font-weight: 800; margin: 0; }
    .chapter-sub { margin: 4px 0 0; font-size: 12px; color: var(--muted); }

    /* Video Modal */
    .video-modal { position: fixed; inset: 0; z-index: 5000; display: none; }
    .video-modal.show { display: block; }
    .video-modal-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(8px); }
    .video-modal-panel {
      position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);
      width: min(860px, calc(100vw - 32px)); border-radius: 22px;
      background: #1c1c1e; border: 1px solid rgba(255,255,255,0.1);
      box-shadow: 0 30px 80px rgba(0,0,0,0.6); overflow: hidden;
    }
    .video-modal-close {
      position: absolute; right: 12px; top: 12px; width: 38px; height: 38px;
      border-radius: 50%; border: none; background: rgba(255,255,255,0.1);
      color: #fff; cursor: pointer; font-size: 22px; display: flex; align-items: center; justify-content: center; z-index: 2;
    }
    .video-wrap { background: #000; }
    .video-wrap video { display: block; width: 100%; max-height: min(70vh, 520px); }

/* å®¹å™¨ï¼šéš±è—æº¢å‡ºä¸¦å…è¨±æ»‘å‹• */
.day-scroll-container {
    width: 100%;
    overflow: hidden;
    padding: 10px 0;
    margin-bottom: 10px;
}

.day-scroll-wrapper {
    display: flex;
    gap: 12px;
    overflow-x: auto; 
    padding: 10px 20px; /* å¢åŠ åº•éƒ¨ Padding é˜²æ­¢é™°å½±è¢«åˆ‡æ‰ */
    
    /* éš±è—æ»¾å‹•æ¢ */
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none; /* Firefox */
}

.day-scroll-wrapper::-webkit-scrollbar {
    display: none; /* Chrome, Safari */
}

/* Chip æ¨£å¼ï¼šå»¶çºŒä½ çš„ç»ç’ƒæ“¬æ…‹é¢¨æ ¼ */
.day-chip {
    flex-shrink: 0;
    padding: 10px 22px;
    border-radius: 999px;
    color: #fff;
    font-size: 13px;
    font-weight: 700;
    text-decoration: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}
/* Day 0 & 5: å»ˆé–€ (æš–æ©˜èª¿ 20Â°C) */
.chip-warm {
    background: linear-gradient(135deg, #ff7e5f 0%, #feb47b 100%);
    box-shadow: 0 4px 12px rgba(255, 126, 95, 0.3);
}

/* Day 1: å“ˆçˆ¾æ¿±å¸‚å€ (éæ¸¡è—ç´« -10Â°C) */
.chip-cool {
    background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
    box-shadow: 0 4px 12px rgba(106, 17, 203, 0.3);
}

/* Day 2, 3, 4: äºå¸ƒåŠ›/é›ªé„‰/å¤§ä¸–ç•Œ (æ¥µå¯’å†°è— -25Â°C) */
.chip-frozen {
    background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    box-shadow: 0 4px 15px rgba(79, 172, 254, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.4);
}



.day-chip:hover {
    background: rgba(255, 255, 255, 0.15);
    border-color: var(--accent);
transform: translateY(-8px); /* å‘ä¸Šæµ®èµ·æ›´å¤šï¼Œæ›´æ˜é¡¯ */
    z-index: 20; /* ç¢ºä¿ç•¶å‰æ‡¸æµ®çš„æŒ‰éˆ•åœ¨æœ€å‰æ–¹ */
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);   
    
}

/* é‡å°ç›®å‰æ‰€åœ¨é é¢çš„é«˜äº® (é¸é…) */
.day-chip.active {
    background: var(--accent);
    color: #000;
    border-color: var(--accent);
}






    /* Editor HUD (ç¶­æŒåŸæ¨£) */
    .pin-editor {
      position: fixed; left: 24px; bottom: 24px; z-index: 2000;
      background: rgba(28, 28, 30, 0.9); backdrop-filter: blur(20px);
      border-radius: 24px; box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      padding: 24px; width: min(560px, calc(100vw - 48px)); display: none;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .pin-editor.show { display: block; }
    .pin-editor .btn { border: none; background: var(--accent); color: #fff; padding: 10px 20px; border-radius: 999px; cursor: pointer; }
    .pin-editor pre { background: rgba(0,0,0,0.3); padding: 14px; border-radius: 16px; font-size: 11px; margin-top: 16px; max-height: 200px; overflow: auto; border: 1px solid rgba(255,255,255,0.05); }

    /* --- Modals --- */
    .video-modal { position: fixed; inset: 0; z-index: 5000; display: none; }
    .video-modal.show { display: block; }
    .video-modal-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); }
    .video-modal-panel {
      position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%);
      width: min(900px, 95vw); border-radius: 24px; overflow: hidden;
      background: #000; box-shadow: 0 50px 100px rgba(0,0,0,0.8);
    }

    @media (max-width: 860px) {
      .chapter-grid { grid-template-columns: repeat(2, 1fr); }
      .pin-thumb { width: 32px; height: 32px; }
    }
    @media (max-width: 500px) {
      .chapter-grid { grid-template-columns: 1fr; }
      .video-dock { flex-direction: column; align-items: flex-start; }
      .video-dock-btn { width: 100%; text-align: center; }
      .map-head { flex-direction: column; align-items: flex-start; }
      .album-cta { width: 100%; justify-content: center; }
    }
/* 2. é‡å°æ‰‹æ©Ÿç‰ˆ (è¢å¹•å¯¬åº¦ < 600px) çš„ç²¾ç¢ºè¨­å®š */
@media (max-width: 600px) {
    .family-line {
        gap: 2px;
        padding: 0 45px;
    }
    .chibi-char {
        width: 40px;
    }

    /* ğŸ”´ å¹³æ™‚ç‹€æ…‹ï¼šåªåœ¨æ²’æœ‰ .throwing æ™‚æ’­æ”¾å‘¼å¸ */
    .chibi-char:not(.throwing) .chibi-sprite {
        transform: translateX(-50%) scale(0.12); 
        animation: chibi-breath-mobile 2.5s infinite ease-in-out !important;
    }

    /* ğŸ”´ æŠ•æ“²ç‹€æ…‹ï¼šå¼·è¡Œå–ä»£æ‰€æœ‰å‹•ç•« */
    .chibi-char.throwing .chibi-sprite {
        /* å¿…é ˆç¢ºä¿æ¯”ä¾‹ç¶­æŒ 0.12 */
        transform: translateX(-50%) scale(0.12) !important;
        /* æ’­æ”¾æŠ•æ“²åºåˆ—åœ–å‹•ç•«ï¼Œä¸¦å–æ¶ˆå‘¼å¸å‹•ç•« */
        animation: chibi-action-play 0.6s steps(5) forwards !important;
    }
.chapter-grid {
        grid-template-columns: repeat(2, 1fr) !important; /* æ‰‹æ©Ÿç‰ˆç¶­æŒå…©æ¬„ï¼Œæ¯”è¼ƒä¸ä½”ç©ºé–“ */
        gap: 8px !important;
    }
    
    .chapter-card {
        padding: 10px !important;
    }
    
    .chapter-title {
        font-size: 12px !important;
    }
}




    /* -------------------------------------------
       â„ï¸ NEW: å®¶æ—äº’å‹•åº•åº§æ¨£å¼ (å®Œå…¨å¤–æ›ï¼Œä¸å½±éŸ¿æ’ç‰ˆ)
       ------------------------------------------- */

/* ç¸½å®¹å™¨ï¼šå–æ¶ˆåŸæœ¬çš„ clip-path */
.footer-game-zone-wrap {
    position: fixed;
    bottom: 0; left: 0; width: 100%; height: 125px;
    z-index: 200;
    pointer-events: none;
}





/* é›ªäººæŒ‰éˆ•å®šä½ */
.snowman-btn {
    position: absolute; bottom: 32px;
    width: 80px; height: 80px;
    z-index: 230; /* ğŸŸ¢ ç¢ºä¿åœ¨æœ€å‰é¢ */
    pointer-events: auto;
    -webkit-tap-highlight-color: transparent;
}
    .snowman-btn:hover { transform: scale(1.15); }
    .snowman-btn:active { transform: scale(0.9); }
    .snowman-btn.left { left: -4%; }
    .snowman-btn.right { right: -4%; }

.snowman-btn, .chibi-char {
    cursor: pointer;
    -webkit-touch-callout: none; /* å†æ¬¡ç¢ºä¿è§’è‰²èˆ‡æŒ‰éˆ•ä¸æœƒè§¸ç™¼é•·æŒ‰èœå–® */
}

/* 2. äººç‰©å±¤ï¼šæµ®åœ¨æœ€ä¸Šæ–¹ï¼Œä¸è¢«è£åˆ‡ */
.family-line {
    position: absolute;
    bottom: 22px; /* ğŸŸ¢ èª¿æ•´é€™å€‹å€¼ï¼Œè®“è§’è‰²è…³åº•å‰›å¥½è¸©åœ¨é›ªåœ°å¼§ç·šä¸Š */
    left: 0; width: 100%;
    display: flex; justify-content: center;
    overflow: visible !important; 
    z-index: 220; 
    pointer-events: auto;
}

/* å¼§å½¢é›ªåœ°å±¤ï¼šå°ˆå¿ƒè² è²¬èƒŒæ™¯ */
.snow-base-layer {
    position: absolute;
    bottom: 0; left: 0; width: 100%; height: 40px;
    background: linear-gradient(to bottom, #ffffff 0%, #e0f0ff 100%);
    clip-path: ellipse(190% 100% at 50% 100%); /* ğŸŸ¢ æ¨™æº–å¹³ç·©å¼§åº¦ */
    z-index: 9;
    filter: drop-shadow(0 -5px 10px rgba(114, 148, 241, 0.3));
}



.chibi-char {
    position: relative;
    width: 50px;  /* å®¹å™¨å¯¬åº¦ */
    height: 80px; /* å®¹å™¨é«˜åº¦ */
    display: flex;
    justify-content: center;
    align-items: flex-end;
    overflow: visible !important;
}

.chibi-sprite {
    position: absolute;
    bottom: 0; /* è…³åº•é–å®šå®¹å™¨åº•éƒ¨ */
    left: 50%;
    /* çµ±ä¸€å®šä½èˆ‡ç¸®æ”¾ï¼Œé˜²æ­¢ä½ç§» */
    transform: translateX(-50%) scale(0.14);
    transform-origin: bottom center;

    width: 160px;   /* æ–°çš„å–®æ ¼å¯¬åº¦ */
    height: 260px;  /* æ–°çš„å–®æ ¼é«˜åº¦ */
    background-size: 960px 260px; /* ç¸½å¯¬åº¦ (160*6) èˆ‡ é«˜åº¦ */
    background-repeat: no-repeat;
    /* é—œéµï¼šå‚ç›´å¿…é ˆç‚º 0ï¼Œè§£æ±ºé ­éƒ¨æˆ–è…³éƒ¨è¢«åˆ‡æ‰çš„å•é¡Œ */
    background-position: 0px 0px; 
    
    filter: drop-shadow(0 15px 20px rgba(0,0,0,0.4));
    image-rendering: auto;
    z-index: 10;
    transition: none; /* é˜²æ­¢ä½ç§»ç·©è¡ */
/* è¨­å®šå‹•ç•«ï¼š2ç§’ä¸€å€‹å¾ªç’°ï¼Œå¹³æ»‘é€²å‡ºï¼Œç„¡é™å¾ªç’° */
    animation: chibi-breath 1.7s infinite ease-in-out;
    
    /* ç¢ºä¿ç¸®æ”¾ä¸­å¿ƒåœ¨è…³åº•ï¼Œé€™æ¨£å‘¼å¸æ™‚è…³ä¸æœƒé›¢åœ° */
    transform-origin: bottom center;

/* ğŸ”´ æ ¸å¿ƒä¿®æ­£ï¼šå¼·åˆ¶é–‹å•Ÿç¡¬é«”åŠ é€Ÿèˆ‡ 3D æ¸²æŸ“å±¤ */
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    transform-style: preserve-3d;
    perspective: 1000px;
    
    /* æç¤ºç€è¦½å™¨é€™äº›å±¬æ€§æœƒè®Šå‹•ï¼Œä¸è¦è£åˆ‡å¿«å– */
   will-change: transform, background-position; /* é å‘Šç€è¦½å™¨é€™å…©é …æœƒè®Šå‹• */
    transform: translateZ(0); /* å¼·åˆ¶é–‹å•Ÿ GPU ç¡¬é«”åŠ é€Ÿ */ 
    
    
}
    
/* ğŸ’¡ æ›´æ–°å¾Œçš„ Sprite æ¨£å¼ */
/* 2. ä½¿ç”¨çµ•å°å®šä½å¼·åˆ¶è…³åº•è²¼é½Š */
.chibi-sprite {
  background-size: contain;
    position: absolute;
    bottom: 0;          /* å¼·åˆ¶è…³åº•è²¼é½Šå®¹å™¨åº•éƒ¨ */
    left: 50%;
/* é¡¯ç¤ºå¤§å°ä¾ç„¶ç”¨ transform ç¸®æ”¾æ§åˆ¶ */
    transform: translateX(-50%) scale(0.5); /* å‡è¨­åœ¨ 80px çš„å®¹å™¨ä¸­ */
    


    width: 307px;
    height: 498px;
    background-size: 1842px 498px;
    background-repeat: no-repeat;

    
    /* é€™è£¡ä¸éœ€è¦ä»»ä½• margin-bottom */
    margin: 0 !important; 
    
    filter: drop-shadow(0 15px 20px rgba(0,0,0,0.4));
    image-rendering: auto;
}

.family-line {
    display: flex;
    gap: 0px; /* ç¸®æ”¾å¾Œè²  margin å·²è™•ç†é–“è·ï¼Œè¨­ç‚º 0 */
    align-items: flex-end;
    justify-content: center; /* è®“å®¶æ—æˆå“¡å±…ä¸­æ’åˆ— */
    padding: 0 60px;
    width: 100%;
}

/* 1. ç¢ºä¿çˆ¶å®¹å™¨æœ‰è¶³å¤ ç©ºé–“ï¼Œä¸”ä¸è£åˆ‡å…§å®¹ */
.chibi-char {
    position: relative;
    width: 60px;       /* ç¸®æ”¾å¾Œçš„è¦–è¦ºå¯¬åº¦ */
    height: 100px;      /* ä½ å¸Œæœ›è§’è‰²ç«™ç«‹çš„é«˜åº¦ç¯„åœ */
    display: flex;
    justify-content: center;
    align-items: flex-end; 
    overflow: visible !important; /* ç¢ºä¿ä¸è¢«è£åˆ‡ */
}

/* å°è©±æ¡†ä¸»é«” */
.tip-bubble {
    position: absolute;
    bottom: 110%; /* é¡¯ç¤ºåœ¨é›ªäººé ­é ‚ä¸Šæ–¹ */
    left: 50%;
    transform: translateX(-50%);
    background: #00000065; /* æé†’ç´… */
    color: white;
    padding: 6px 12px;
    border-radius: 12px;
    font-size: 13px;
    font-weight: bold;
    white-space: nowrap;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    z-index: 100;
    display: none; /* é è¨­éš±è—ï¼Œç”± JS æ§åˆ¶é¡¯ç¤º */
}

/* å°è©±æ¡†çš„å°å°¾å·´ (ä¸‰è§’å½¢) */
.tip-bubble::after {
    content: "";
    position: absolute;
    top: 100%; /* åœ¨å°è©±æ¡†æ­£ä¸‹æ–¹ */
    left: 50%;
    margin-left: -30px;
    border-width: 6px;
    border-style: solid;
    border-color: #00000065 transparent transparent transparent;
}

/* å‘¼å¸å‹•ç•«è®“å®ƒæ›´é¡¯çœ¼ */
.tip-bubble.show {
    display: block;
    animation: bubble-float 2s infinite ease-in-out;
}

@keyframes bubble-float {
    0%, 100% { transform: translateX(-50%) translateY(0); }
    50% { transform: translateX(-50%) translateY(-5px); }
}





/* ä¸Ÿçƒå‹•ä½œï¼šç¹¼æ‰¿ transform ç¢ºä¿ä¸ä½ç§» */
.chibi-char.throwing .chibi-sprite {
  
    transform: translateX(-50%) scale(0.14);
    animation: chibi-action-play 0.35s steps(5) forwards;
    
}
    .snowball-projectile {
        position: fixed; width: 16px; height: 16px;
        background: radial-gradient(circle at 30% 30%, #fff, #b1c9e8);
        border-radius: 50%; z-index: 1000;
        box-shadow: 0 0 15px rgba(255,255,255,0.8);
        pointer-events: none;
    }

    .hit-spark {
        position: fixed; width: 10px; height: 10px;
        background: white; border-radius: 50%; z-index: 1001;
    }
@keyframes chibi-action-play {
    from { background-position: 0px 0px; }
    /* çµæŸä½ç½®æ˜¯ -(ç¸½å¯¬ - å–®æ ¼å¯¬) = -(1842 - 307) = -1535 */
    to { background-position: -1535px 0px; } 
}

/* è¨­å®šæ¯å€‹è§’è‰²çš„åœ–ç‰‡è·¯å¾‘ */
#chibi-0 .chibi-sprite { background-image: url('images/runners/dad/runner_combined.webp'); }
#chibi-1 .chibi-sprite { background-image: url('images/runners/mom/runner_combined.webp'); }
#chibi-2 .chibi-sprite { background-image: url('images/runners/bro/runner_combined.webp'); }
#chibi-3 .chibi-sprite { background-image: url('images/runners/yan/runner_combined.webp'); }
#chibi-4 .chibi-sprite { background-image: url('images/runners/me/runner_combined.webp'); }
#chibi-5 .chibi-sprite { background-image: url('images/runners/di/runner_combined.webp'); }
#chibi-6 .chibi-sprite { background-image: url('images/runners/vi/runner_combined.webp'); }
/* ä¿®æ­£ VS Code çš„ line-clamp è­¦å‘Š */
.album-sub {
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    line-clamp: 2; /* åŠ ä¸Šé€™è¡Œæ¨™æº–å±¬æ€§å³å¯ */
    overflow: hidden;
}


  </style>
</head>
<body>

  <!-- 1. ä¸‹é›ªèƒŒæ™¯å±¤ -->
  <canvas id="snowCanvas"></canvas>

  <div class="app-wrap">
    <div class="topbar">
      <div class="topbar-inner">
        <div class="brand">
          <h1>æ—…è¡Œå›æ†¶ï½œå“ˆçˆ¾æ¿±</h1>
          <div class="meta">ç´€æšå¯¶è²å€‘çš„2025å“ˆçˆ¾æ¿±ä¹‹æ—…</div>
        </div>
        <div class="pill">6 DAYS</div>
      </div>
    </div>

    <div class="wrap">


      <section class="map-card">
        <div class="map-head">
          <div class="map-head-left">
            <p class="t">å“ˆçˆ¾æ¿±å›æ†¶åœ°åœ–</p>
            <p class="s">2025/12/25~2025/12/30</p>
          </div>
          <div class="map-chips">
            <a class="album-cta" href="index0.html"><span>&#x1F4F7; çœ‹ç›¸ç°¿ç¸½è¦½</span></a>
          </div>
        </div>

        <!-- âœ… é€™è£¡å®Œå…¨ç¶­æŒä½ åŸæœ¬çš„ HTML çµæ§‹èˆ‡åº§æ¨™ -->
        <div class="map-stage" id="mapStage">
          <img src="images/harbin_map.webp" alt="Harbin map">

          <!-- Circle Thumbnail Pins -->
          <a class="pin" data-day="day00" data-pin="xiamen_d0" href="day00.html" style="left:26.2%; top:69.93%;">
            <span class="pin-thumb"><img src="images/pins/Day0.webp" alt=""></span>
            <span class="pin-label">å»ˆé–€ â†’ Day0</span>
          </a>
          <a class="pin" data-day="day01" data-pin="sophia_d1" href="day01.html" style="left:28.38%; top:23.11%;">
            <span class="pin-thumb"><img src="images/pins/Day1.webp" alt=""></span>
            <span class="pin-label">è–ç´¢è²äºæ•™å ‚ â†’ Day1</span>
          </a>
          <a class="pin" data-day="day02" data-pin="yabuli_d2" href="day02.html" style="left:60.05%; top:50.86%;">
            <span class="pin-thumb"><img src="images/pins/Day2.webp" alt=""></span>
            <span class="pin-label">äºå¸ƒåŠ› â†’ Day2</span>
          </a>
          <a class="pin" data-day="day03" data-pin="tutou_d3" href="day03.html" style="left: 85%; top:60.8%;">
            <span class="pin-thumb"><img src="images/pins/Day3.webp" alt=""></span>
            <span class="pin-label">å¤§ç¦¿é ‚å­å±± â†’ Day3</span>
          </a>
          <a class="pin" data-day="day03" data-pin="snow_d3" href="day03.html" style="left:76.52%; top:75.62%;">
            <span class="pin-thumb"><img src="images/pins/Day4.webp" alt=""></span>
            <span class="pin-label">é›ªé„‰ â†’ Day3</span>
          </a>
          <a class="pin" data-day="day04" data-pin="gallery_d4" href="day04.html" style="left:56.17%; top:78.64%;">
            <span class="pin-thumb"><img src="images/pins/Day5.webp" alt=""></span>
            <span class="pin-label">å†°é›ªç•«å»Š â†’ Day4</span>
          </a>
          <a class="pin" data-day="day04" data-pin="iceworld_d4" href="day04.html" style="left:13.49%; top:10.18%;">
            <span class="pin-thumb"><img src="images/pins/Day6.webp" alt=""></span>
            <span class="pin-label">å†°é›ªå¤§ä¸–ç•Œ â†’ Day4</span>
          </a>
          <a class="pin" data-day="day04" data-pin="centralst_d4" href="day04.html" style="left:36.8%; top:12.16%;">
            <span class="pin-thumb"><img src="images/pins/Day7.webp" alt=""></span>
            <span class="pin-label">ä¸­å¤®å¤§è¡— â†’ Day4</span>
          </a>
          <a class="pin" data-day="day05" data-pin="xiamen_d5" href="day05.html" style="left:10.98%; top:50.33%;">
            <span class="pin-thumb"><img src="images/pins/Day8.webp" alt=""></span>
            <span class="pin-label">å»ˆé–€ â†’ Day5</span>
          </a>




          
          <!-- Anchor Pins -->
          <a class="anchor" data-pin="xiamen_d0" href="day00.html" style="left:20.77%; top:79.85%;"></a>
          <a class="anchor" data-pin="sophia_d1" href="day01.html" style="left:22.67%; top:11.13%;"></a>
          <a class="anchor" data-pin="yabuli_d2" href="day02.html" style="left:69.75%; top:71.47%;"></a>
          <a class="anchor" data-pin="tutou_d3" href="day03.html" style="left:64.49%; top:88.26%;"></a>
          <a class="anchor" data-pin="snow_d3" href="day03.html" style="left:63.35%; top:98.07%;"></a>
          <a class="anchor" data-pin="gallery_d4" href="day04.html" style="left:63.73%; top:90.53%;"></a>
          <a class="anchor" data-pin="iceworld_d4" href="day04.html" style="left:20.98%; top:10.25%;"></a>
          <a class="anchor" data-pin="centralst_d4" href="day04.html" style="left:22.23%; top:10.49%;"></a>
          <a class="anchor" data-pin="xiamen_d5" href="day05.html" style="left:12.92%; top:84.33%;"></a>

          
        </div>

<div class="day-scroll-container">
    <div class="day-scroll-wrapper">
        <a href="day00.html" class="day-chip chip-warm">Day 0 å»ˆé–€ â˜€</a>
        <a href="day01.html" class="day-chip chip-cool">Day 1 å“ˆçˆ¾æ¿± â˜</a>
        <a href="day02.html" class="day-chip chip-frozen">Day 2 äºå¸ƒåŠ› â„</a>
        <a href="day03.html" class="day-chip chip-frozen">Day 3 é›ªé„‰ â˜ƒ</a>
        <a href="day04.html" class="day-chip chip-frozen">Day 4 å¤§ä¸–ç•Œ ğŸ§Š</a>
        <a href="day05.html" class="day-chip chip-warm">Day 5 å»ˆé–€ ğŸ </a>
    </div>
</div>


<div class="video-dock" id="videoDock" style="display: flex !important;">
    <div class="video-preview-box">
        <video id="inlineVideo" muted autoplay loop playsinline style="width: 100%; height: 100%; object-fit: cover; opacity: 0.8;">
            <source src="videos/harbin_hero.mp4" type="video/mp4">
        </video>
    </div>
    
    <div class="video-dock-title">
        <div class="kicker">Highlights</div>
        <div class="name">å›é¡§ 50s ç²¾è¯</div>
    </div>
    
    <button class="video-dock-btn" id="openVideoBtn" style="padding: 8px 14px; font-size: 12px;">â–¶ æ’­æ”¾</button>
</div>

        <div class="chapters">
          <h3>ç« ç¯€å…¥å£</h3>
        <div class="chapter-grid">
          <a class="chapter-card" href="day00.html">
            <span class="chapter-dot" aria-hidden="true"></span>
            <div class="chapter-text">
              <p class="chapter-title">Day0 å»ˆé–€</p>
              <p class="chapter-sub">é‡‘é–€/å»ˆé–€/æµ·é¦¬é«”ç…§ç›¸é¤¨</p>
            </div>
          </a>
          <a class="chapter-card" href="day01.html">
            <span class="chapter-dot" aria-hidden="true"></span>
            <div class="chapter-text">
              <p class="chapter-title">Day1 å“ˆçˆ¾æ¿±å¸‚å€</p>
              <p class="chapter-sub">ä¸­å¤®å¤§è¡—/è–ç´¢è²äº/è¡£å½¬ä¹‹å®¶</p>
            </div>
          </a>
          <a class="chapter-card" href="day02.html">
            <span class="chapter-dot" aria-hidden="true"></span>
            <div class="chapter-text">
              <p class="chapter-title">Day2 äºå¸ƒåŠ›</p>
              <p class="chapter-sub">é¦¬æ‹‰çˆ¬çŠ/æ£®æ—å°ç«è»Š/ä¿„å¼å°é»</p>
            </div>
          </a>
          <a class="chapter-card" href="day03.html">
            <span class="chapter-dot" aria-hidden="true"></span>
            <div class="chapter-text">
              <p class="chapter-title">Day3 äºå¸ƒåŠ›â†’é›ªé„‰</p>
              <p class="chapter-sub">æ»‘é›ª/å¤§ç¦¿é ‚å­å±±/é›ªé„‰/äºŒäººè½‰</p>
            </div>
          </a>
          <a class="chapter-card" href="day04.html">
            <span class="chapter-dot" aria-hidden="true"></span>
            <div class="chapter-text">
              <p class="chapter-title">Day4 é›ªé„‰â†’å†°é›ªå¤§ä¸–ç•Œ</p>
              <p class="chapter-sub">å†°é›ªç•«å»Š/å†°é›ªå¤§ä¸–ç•Œ/å“ˆçˆ¾æ¿±ä¸­å¤®å¤§è¡—</p>
            </div>
          </a>
          <a class="chapter-card" href="day05.html">
            <span class="chapter-dot" aria-hidden="true"></span>
            <div class="chapter-text">
              <p class="chapter-title">Day5 å»ˆé–€</p>
              <p class="chapter-sub">å“ˆçˆ¾æ¿±â†’å»ˆé–€</p>
            </div>
            </a>
          </div>
        </div>
      </section>
    </div>
  </div>




  
  <!-- -------------------------------------------
       â„ï¸ NEW: å®¶æ—äº’å‹•åº•åº§ HTML çµæ§‹
       ------------------------------------------- -->
<div class="footer-game-zone-wrap">
    
    <div class="family-line" id="familyLine"></div>

    <div class="snow-base-layer"></div>

    <div class="snowman-btn left" onclick="attack('left')">
        <img src="images/runners/snowman02.webp" alt="å·¦é›ªäºº" style="width: 100%; height: auto;">
        <span id="attack-tip" class="tip-bubble">é»æˆ‘å¯æ”»æ“Š!</span>
    </div>

    <div class="snowman-btn right" onclick="attack('right')">
        <img src="images/runners/snowman01.webp" alt="å³é›ªäºº" style="width: 100%; height: auto;">
    </div>
</div>






  <!-- Editor HUD -->
  <div class="pin-editor" id="pinEditor">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <strong>Pin ç·¨è¼¯æ¨¡å¼ (æŒ‰ E)</strong>
      <button class="btn" id="copyPinsBtn">è¤‡è£½æ¨™è¨˜ HTML</button>
    </div>
    <pre id="pinDump"></pre>
  </div>

  <!-- Video Modal -->
  <div class="video-modal" id="videoModal">
    <div class="video-modal-backdrop" data-close="1"></div>
    <div class="video-modal-panel">
      <button class="video-modal-close" id="closeVideoBtn">Ã—</button>
      <div class="video-wrap">
        <video id="heroVideo" playsinline muted preload="metadata" controls>
          <source src="videos/harbin_hero.mp4" type="video/mp4">
        </video>
      </div>
    </div>
  </div>

  <script>
    /* --- ä¸‹é›ªè…³æœ¬ (ä¸å½±éŸ¿ç‰ˆé¢) --- */
    const canvas = document.getElementById('snowCanvas');
    const ctx = canvas.getContext('2d');
    let width, height, snowflakes = [];

    function initSnow() {
      width = window.innerWidth;
      height = window.innerHeight;
      canvas.width = width;
      canvas.height = height;
      const count = Math.floor((width * height) / 9000);
      snowflakes = [];
      for (let i = 0; i < count; i++) {
        snowflakes.push({
          x: Math.random() * width,
          y: Math.random() * height,
          size: Math.random() * 3 + 1,
          speed: Math.random() * 1 + 0.5,
          velX: Math.random() * 0.5 - 0.25,
          opacity: Math.random() * 0.5 + 0.2
        });
      }
    }
    function updateSnow() {
      ctx.clearRect(0, 0, width, height);
      snowflakes.forEach(s => {
        s.y += s.speed;
        s.x += s.velX;
        if (s.y > height) { s.y = -10; s.x = Math.random() * width; }
        ctx.fillStyle = `rgba(255, 255, 255, ${s.opacity})`;
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
        ctx.fill();
      });
      requestAnimationFrame(updateSnow);
    }
    window.addEventListener('resize', initSnow);
    initSnow();
    updateSnow();


    // -------------------------------------------
    // â„ï¸ NEW: å®¶æ—äº’å‹•åº•åº§ JS é‚è¼¯
    // -------------------------------------------
const CHIBI_DATA = [
    { name: "çˆ¸çˆ¸", folder: "dad" },
    { name: "åª½åª½", folder: "mom" },
    { name: "å“¥å“¥", folder: "bro" },
    { name: "è¨€",   folder: "yan" },
    { name: "æˆ‘",   folder: "me" },
    { name: "å¼Ÿ",   folder: "di" },
    { name: "Vi",   folder: "vi" }
];

// ç¢ºä¿è§’è‰²å®¹å™¨å¯¬åº¦è¶³å¤ é¡¯ç¤ºç¸®æ”¾å¾Œçš„åœ–ç‰‡
function initInteractiveFooter() {
    const container = document.getElementById('familyLine'); // ğŸŸ¢ ç¢ºèª ID åŒ¹é…
    if (!container) {
        console.log("æ‰¾ä¸åˆ° familyLine å®¹å™¨ï¼");
        return;
    }
    
    container.innerHTML = CHIBI_DATA.map((char, i) => `
        <div class="chibi-char" id="chibi-${i}" title="${char.name}">
            <div class="chibi-sprite" style="background-image: url('images/runners/${char.folder}/runner_combined.webp')"></div>
        </div>
    `).join('');
}

// é é¢è¼‰å…¥å¾Œå•Ÿå‹•
window.addEventListener('DOMContentLoaded', initInteractiveFooter);

// 3. attack å‡½å¼å°±èƒ½è®€åˆ° CHIBI_DATA.length äº†
function attack(fromSide) {
    // ğŸ”´ æ ¸å¿ƒä¿®æ­£ï¼šåªè¦é»æ“Šé›ªäººï¼ˆä¸è«–å·¦å³ï¼‰ï¼Œå°±è§¸ç™¼æ¶ˆå¤±é‚è¼¯
    const tip = document.getElementById('attack-tip');
    if (tip) {
        localStorage.setItem('hasSeenSnowmanTip', 'true'); // ç´€éŒ„å·²çœ‹é
        tip.style.opacity = '0'; // å¹³æ»‘æ·¡å‡º
        setTimeout(() => tip.classList.remove('show'), 500); // 500ms å¾Œç§»é™¤
    }

    // --- ä»¥ä¸‹æ˜¯ä½ åŸæœ¬çš„é›ªçƒç™¼å°„é‚è¼¯ï¼Œä¸ç”¨å‹• ---
    const luckyIdx = Math.floor(Math.random() * CHIBI_DATA.length);
    const charEl = document.getElementById(`chibi-${luckyIdx}`);
    if (!charEl) return;
    
    charEl.classList.add('throwing');
    setTimeout(() => charEl.classList.remove('throwing'), 600);

    // å‰µå»ºé›ªçƒ
    const ball = document.createElement('div');
    ball.className = 'snowball-projectile';
    document.body.appendChild(ball);

    // èµ·é»åº§æ¨™ (å¾è§’è‰²ä¸­å¿ƒé»ç™¼å°„)
    const charRect = charEl.getBoundingClientRect();
    const startX = charRect.left + charRect.width / 2;
    const startY = charRect.top + 20;

    // çµ‚é»åº§æ¨™ (ç›®æ¨™é›ªäºº)
    const targetSide = fromSide === 'left' ? 'right' : 'left';
    const targetBtn = document.querySelector(`.snowman-btn.${targetSide}`);
    const targetRect = targetBtn.getBoundingClientRect();
    const endX = targetRect.left + targetRect.width / 2;
    const endY = targetRect.top + 30;

    // æ‹‹ç‰©ç·šå‹•ç•«
    let progress = 0;
    const speed = 0.03;
    const peak = 150; 

    function frame() {
        progress += speed;
        const x = startX + (endX - startX) * progress;
        const y = startY + (endY - startY) * progress - Math.sin(progress * Math.PI) * peak;

        ball.style.left = x + 'px';
        ball.style.top = y + 'px';
        ball.style.transform = `scale(${1.2 - progress * 0.4}) rotate(${progress * 720}deg)`;

        if (progress < 1) {
            requestAnimationFrame(frame);
        } else {
            ball.remove();
            createHitEffect(endX, endY, targetBtn);
        }
    }
    requestAnimationFrame(frame);
}

    function createHitEffect(x, y, el) {
        // é›ªäººéœ‡å‹•
        el.style.transform = 'scale(0.8) rotate(10deg)';
        setTimeout(() => el.style.transform = '', 150);

        // çˆ†è£‚é›ªèŠ±é¡†ç²’
        for(let i=0; i<10; i++) {
            const p = document.createElement('div');
            p.className = 'hit-spark';
            p.style.left = x + 'px';
            p.style.top = y + 'px';
            document.body.appendChild(p);

            const angle = Math.random() * Math.PI * 2;
            const dist = 30 + Math.random() * 40;
            p.animate([
                { transform: 'translate(0,0) scale(1)', opacity: 1 },
                { transform: `translate(${Math.cos(angle)*dist}px, ${Math.sin(angle)*dist}px) scale(0)`, opacity: 0 }
            ], { duration: 500, easing: 'ease-out' }).onfinish = () => p.remove();
        }
    }

 


    /* --- åŸæœ¬çš„ Pin é‚è¼¯ (å®Œå…¨ä¿ç•™) --- */
    (() => {
      const stage = document.getElementById('mapStage');
      const pins = [...document.querySelectorAll('.pin[data-pin]')];
      const anchors = [...document.querySelectorAll('.anchor[data-pin]')];
      const editor = document.getElementById('pinEditor');
      const dump = document.getElementById('pinDump');
      const copyBtn = document.getElementById('copyPinsBtn');

      let editing = false, dragging = null, offset = {x:0,y:0};
      const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));

      // æ¸²æŸ“ Anchor åœ–æ¨™
      const dropSVG = () => `<svg viewBox="0 0 24 24"><circle class="pin-head" cx="12" cy="8" r="5.2"/><circle class="pin-head-stroke" cx="12" cy="8" r="5.2" fill="none" stroke-width="1.8"/><path class="pin-needle" d="M12 13 L10.8 22 L13.2 22 Z"/><path class="pin-needle-stroke" d="M12 13 L10.8 22 L13.2 22 Z" fill="none" stroke-width="1.2"/></svg>`;
      anchors.forEach(a => a.innerHTML = dropSVG());

      const pinById = new Map(pins.map(p => [p.dataset.pin, p]));
      const anchorsById = new Map();
      anchors.forEach(a => {
        const id = a.dataset.pin;
        if(!anchorsById.has(id)) anchorsById.set(id, []);
        anchorsById.get(id).push(a);
      });

      function setHot(id, on){
        const p = pinById.get(id);
        if(p) p.classList.toggle('is-hot', on);
        (anchorsById.get(id) || []).forEach(a => a.classList.toggle('is-hot', on));
      }

      pins.forEach(p=>{
        p.addEventListener('mouseenter', () => setHot(p.dataset.pin, true));
        p.addEventListener('mouseleave', () => setHot(p.dataset.pin, false));
      });
      anchors.forEach(a=>{
        a.addEventListener('mouseenter', () => setHot(a.dataset.pin, true));
        a.addEventListener('mouseleave', () => setHot(a.dataset.pin, false));
      });

      // æ‹–æ›³é‚è¼¯ (é‡å° E ç·¨è¼¯æ¨¡å¼)
      function beginDrag(el, e){ if(!editing) return; dragging = el; el.setPointerCapture(e.pointerId); const r = el.getBoundingClientRect(); offset.x = (e.clientX - r.left) - r.width/2; offset.y = (e.clientY - r.top) - r.height/2; }
      function doDrag(el, e){ if(!editing || dragging!==el) return; const r = stage.getBoundingClientRect(); const left = clamp(((e.clientX - r.left - offset.x)/r.width)*100, 0, 100).toFixed(2)+'%'; const top = clamp(((e.clientY - r.top - offset.y)/r.height)*100, 0, 100).toFixed(2)+'%'; el.style.left = left; el.style.top = top; updateDump(); }
      
      [...pins, ...anchors].forEach(el => {
        el.addEventListener('pointerdown', e => beginDrag(el, e));
        el.addEventListener('pointermove', e => doDrag(el, e));
        el.addEventListener('pointerup', () => dragging=null);
      });

      window.addEventListener('keydown', e => { if(e.key.toLowerCase()==='e') { editing = !editing; editor.classList.toggle('show', editing); }});

      function updateDump(){
        dump.textContent = pins.map(p => p.outerHTML).join('\n') + '\n' + anchors.map(a => a.outerHTML).join('\n');
      }

      /* --- Video Logic --- */
      const videoModal = document.getElementById('videoModal');
      const heroVideo = document.getElementById('heroVideo');
      const videoDock = document.getElementById('videoDock');
      
      // é—œé–‰å½±ç‰‡æ™‚æ¢å¾©éœéŸ³
function closeVideo(){ 
    videoModal.classList.remove('show'); 
    heroVideo.pause(); 
    // ä¸éœ€è¦éš±è— videoDockï¼Œè®“å®ƒä¸€ç›´å­˜åœ¨åƒå»£å‘Šä¸€æ¨£
}
      document.getElementById('closeVideoBtn').onclick = closeVideo;
      // ä¿®æ”¹å½±ç‰‡é–‹å•Ÿé‚è¼¯
document.getElementById('openVideoBtn').onclick = () => {
    videoModal.classList.add('show');
    heroVideo.currentTime = 0; // é‡é ­é–‹å§‹
    heroVideo.muted = false;   // é–‹æ”¾è²éŸ³
    heroVideo.play();
};
      
      if(!localStorage.getItem('harbin_seen')) setTimeout(()=>videoModal.classList.add('show'), 1000);
      else videoDock.hidden = false;
    })();


function initAttackTip() {
    const tip = document.getElementById('attack-tip');
    
    // æª¢æŸ¥ç€è¦½å™¨ç´€éŒ„ï¼Œæ˜¯å¦æ›¾ç¶“é—œé–‰éæé†’
    const hasSeenTip = localStorage.getItem('hasSeenSnowmanTip');

    if (!hasSeenTip) {
        // å¦‚æœæ²’çœ‹éï¼Œé¡¯ç¤ºå°è©±æ¡†
        tip.classList.add('show');
      
    }
}

// ä¿®æ”¹ä½ åŸæœ¬çš„ attack å‡½å¼ï¼Œç•¶é»æ“Šæ™‚æ°¸ä¹…ç´€éŒ„ã€Œå·²çœ‹éã€
const originalAttack = attack;
attack = function(fromSide) {
    // åŸ·è¡ŒåŸæœ¬çš„æ”»æ“Šé‚è¼¯
    originalAttack(fromSide);
    
    // ç´€éŒ„åˆ° localStorage
    localStorage.setItem('hasSeenSnowmanTip', 'true');
    
    // é»æ“Šå¾Œç«‹åˆ»æ”¶èµ·æé†’
    const tip = document.getElementById('attack-tip');
    if (tip) tip.classList.remove('show');
};

// é é¢è¼‰å…¥å¾Œåˆå§‹åŒ–æé†’
window.addEventListener('load', initAttackTip);


// åœ¨ <script> æ¨™ç±¤å…§çš„æœ€å¾Œé¢åŠ å…¥ï¼š
document.querySelectorAll('.pin').forEach(p => {
    p.addEventListener('click', function() {
    // å…ˆç§»é™¤æ‰€æœ‰äººçš„ active ç‹€æ…‹
        document.querySelectorAll('.pin').forEach(el => el.style.zIndex = "100");
        // æå‡ç•¶å‰é»æ“Šè€…çš„å±¤ç´š
        this.style.zIndex = "999";
        const others = document.querySelectorAll('.pin');
        const anchors = document.querySelectorAll('.anchor');
        
        // é»æ“Šæ™‚è®“å…¶ä»–æ¨™è¨˜è®Šæ·¡ï¼Œçªé¡¯ç•¶å‰åœ°é»
        others.forEach(o => { if (o !== this) o.style.opacity = "0.2"; });
        anchors.forEach(a => a.style.opacity = "0.2");

        // 3 ç§’å¾Œæ¢å¾©æ­£å¸¸
        setTimeout(() => {
            others.forEach(o => o.style.opacity = "1");
            anchors.forEach(a => a.style.opacity = "0.95");
        }, 3000);
    });
});

document.querySelectorAll('.day-chip').forEach(chip => {
    chip.addEventListener('click', function(e) {
        // 1. å–å¾—ç›®æ¨™å¤©æ•¸ (ä¾‹å¦‚ "day01")
        const targetDay = this.getAttribute('href').split('.')[0]; 
        
        const targetPins = document.querySelectorAll(`.pin[data-day="${targetDay}"]`);
        const allPins = document.querySelectorAll('.pin');
        const allAnchors = document.querySelectorAll('.anchor');

        if (targetPins.length > 0) {
            e.preventDefault();

            // è¦–è¦ºè¯å‹•ï¼šçªé¡¯ç›®æ¨™ï¼Œæ·¡åŒ–å…¶ä»–
            allPins.forEach(p => p.style.opacity = "0.2");
            allAnchors.forEach(a => a.style.opacity = "0.2");

            targetPins.forEach(p => {
                p.style.opacity = "1";
                p.style.zIndex = "1000";
                // å¼·åˆ¶è§¸ç™¼æ”¾å¤§æ•ˆæœ
                const thumb = p.querySelector('.pin-thumb');
                thumb.style.transform = "scale(1.5) translateY(-15px)";
                thumb.style.borderColor = "var(--accent)";
            });

            // 2.5 ç§’å¾Œæ¢å¾©ä¸¦è·³è½‰
            setTimeout(() => {
                allPins.forEach(p => {
                    p.style.opacity = "1";
                    p.querySelector('.pin-thumb').style.transform = "";
                    p.querySelector('.pin-thumb').style.borderColor = "";
                });
                allAnchors.forEach(a => a.style.opacity = "0.95");
                
                // ğŸ”´ å°èˆªé«”é©—ï¼šä½¿ç”¨è€…åœ¨æ‰‹æ©Ÿä¸Šçœ‹æ¸…æ¥šä½ç½®å¾Œï¼Œè‡ªå‹•å¹«ä»–è·³è½‰
                window.location.href = this.getAttribute('href');
            }, 2500);
        }
    });
});





    
  </script>
</body>
</html>