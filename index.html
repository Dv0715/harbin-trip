<!DOCTYPE html>
<html lang="zh-Hant">
    <link rel="preload" as="image" href="images/load.webp">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>å“ˆçˆ¾æ¿±å›æ†¶éŒ„ | æ“¦é–‹å†°éœœé–‹å•Ÿæ—…ç¨‹</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; font-family: -apple-system, sans-serif; }

/* èƒŒæ™¯å±¤å®¹å™¨ï¼šæ”¹ç‚ºé»‘è‰²åº•ï¼Œé˜²æ­¢åœ–ç‰‡æ²’å¡«æ»¿æ™‚æ¼å…‰ */
.background-layer {
    position: absolute;
    inset: 0;
    background: #000; /* æ ¸å¿ƒï¼šåº•è‰²å£“æš— */
    z-index: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    transition: transform 1s cubic-bezier(0.4, 0, 0.2, 1);
}

/* åœ–ç‰‡è™•ç†ï¼š object-fit: contain ç¢ºä¿åœ–ç‰‡å®Œæ•´é¡¯ç¤ºï¼Œä¸è¢«è£åˆ‡ */
.memories-img {
    position: absolute;
    width: 95%;          /* ğŸ”´ è®“åœ–ç‰‡åœ¨æ‰‹æ©Ÿä¸Šç¸®å°ä¸€é»ï¼Œéœ²å‡ºæ›´å¤šæš—è§’èˆ‡åº•è‰²ï¼Œæ›´æœ‰å±¤æ¬¡ */
    max-width: 1024px;
    height: auto;
    object-fit: contain;
    z-index: 2;
    border: 1px solid rgba(255,255,255,0.1); /* æ·¡æ·¡çš„é‚Šæ¡†å¢åŠ ç²¾ç·»æ„Ÿ */
    box-shadow: 0 30px 60px rgba(0,0,0,0.8); /* å¼·å¤§çš„é™°å½±è®“ç›¸æ¡†ç«‹é«”åŒ– */
    filter: brightness(0.9) contrast(1.1);
}

/* ğŸ”´ é—œéµï¼šæš—è§’é®ç½© */
.vignette-overlay {
    position: absolute;
    inset: 0;
    z-index: 3;
    /* é€™è£¡ä½¿ç”¨å¾‘å‘æ¼¸å±¤ï¼šä¸­é–“é€æ˜ï¼Œå››å‘¨è®Šæ·±é»‘ */
    background: radial-gradient(circle, rgba(0,0,0,0) 40%, rgba(0,0,0,0.8) 95%, rgba(0,0,0,1) 100%);
    pointer-events: none;
}

/* é‡å°æ‰‹æ©Ÿç›´å¼è¢å¹•çš„å¾®èª¿ */
@media (max-orientation: portrait) {
    .memories-img {
        width: 100vw; /* å¼·åˆ¶å¯¬åº¦æ’æ»¿ */
        height: auto;
    }
}


        /* çª—å¤–çš„é›ªèŠ± */
        #snowCanvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 20;
            pointer-events: none;
            opacity: 0.7;
        }


/* --- è·‘æ­¥å°äººç³»çµ± --- */
.runner-track {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 120px;
    display: flex;
    justify-content: center;
    align-items: flex-end;
    z-index: 999;
    pointer-events: none;
    transform: scale(0.85);
    transform-origin: bottom center;
    /* âœ… å°‡ scale å¾åŸæœ¬çš„ 0.85 æ”¹å°ï¼Œä¾‹å¦‚ 0.5 æˆ– 0.6 */
    transform: scale(0.4); 
    
    /* ç¢ºä¿ç¸®æ”¾æ˜¯è²¼è‘—åº•é‚Šé€²è¡Œçš„ */
    transform-origin: bottom center;
    
    /* å¦‚æœç¸®å°å¾Œè¦ºå¾—å¤ªé è¿‘åº•éƒ¨ï¼Œå¾®èª¿æ­¤å€¼ */
    margin-bottom: 4.5px;
}

.runner {
    /* âœ… é—œéµï¼šå¯¬åº¦è¨­ç‚ºé•·æ¢åœ–çš„ 1/8 (ç´„ 100px)ï¼Œé«˜åº¦å›ºå®š */
    width: 648px; 
    height: 168px;
    background-image: url('images/runners/char00/00.png');
    
    /* âœ… é—œéµï¼šå› ç‚ºæ˜¯ 8 å¹€å¤§åˆé«”ï¼ŒèƒŒæ™¯å¤§å°è¨­ç‚º 800% 100% */
    background-size: 700% 100%; 
    image-rendering: pixelated;
    
    /* âœ… é—œéµï¼šsteps è¨­ç‚º 8ï¼Œå°æ‡‰ä½ çš„ 8 å¼µé€æ ¼åœ– */
    animation: spriteRun 0.55s steps(6) infinite;
}

@keyframes spriteRun {
    from { background-position: 0% 0; }
    to { background-position: 100% 0; }
}

/* æ‰‹æ©Ÿç‰ˆå¾®èª¿ï¼šç¸®å°ä¸€é»é»å³å¯ï¼Œä¿æŒæ¯”ä¾‹ */
    @media (max-width: 240px) {
        .runner {
            width: 50px;
            height: 60px;
        }
        .runner-track {
            height: 80px;
            gap: 8px;
        }
    }


    .app-wrap {
      position: relative;
      z-index: 10;
    }




        /* çª—æˆ¶å†°éœœ */
        #frostCanvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 10;
            cursor: pointer;
            touch-action: none;
            transition: opacity 0.8s ease-in-out, filter 0.8s ease-in-out;
        }

        /* è½‰å ´å•Ÿå‹• */
        .clearing #frostCanvas {
            opacity: 0;
            filter: blur(55px);
            pointer-events: none;
        }
        .clearing .background-layer {
            transform: scale(1.1);
        }

        /* UI å…ƒä»¶å±¤ */
        .ui-overlay {
            position: fixed;
            inset: 0;
            z-index: 30;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 30px;
        }

        /* å¼·åŒ–å¾Œçš„è·³éæŒ‰éˆ• */
        .skip-btn {
            align-self: flex-end;
            pointer-events: auto;
            background: #0071e3;
            color: white;
            padding: 10px 24px;
            border-radius: 99px;
            font-size: 14px;
            font-weight: 800;
            letter-spacing: 0.1em;
            border: 2px solid rgba(255,255,255,0.4);
            box-shadow: 0 8px 20px rgba(0, 113, 227, 0.5);
            transition: all 0.3s ease;
        }
        .skip-btn:hover {
            transform: scale(1.05);
            background: #0082ff;
            border-color: #fff;
        }

        /* æ–‡å­—å¼·åŒ–ï¼šé»‘è‰²è† å›ŠèƒŒæ™¯ */
.hint-capsule {
        position: fixed;
        bottom: 70px; /* é€™è£¡è¦æ¯” runner-track é«˜ */
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
        background: rgba(0, 0, 0, 0.75);
        backdrop-filter: blur(15px);
        padding: 12px 28px;
        border-radius: 99px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        text-align: center;
        color: white;
        pointer-events: none;
        animation: breathe 3s infinite ease-in-out;
    }

    @keyframes spriteRun {
        from { background-position: 0% 0; }
        to { background-position: 100% 0; } 
    }

        .spine-box {
            width: 150px;
            height: 150px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body class="antialiased">

    <!-- èƒŒæ™¯å±¤ -->
<div class="background-layer">
    <img src="images/load.webp" alt="Memories" class="memories-img">
    
    <div class="vignette-overlay"></div>

    <div class="spine-box relative z-10">
        <span class="text-7xl drop-shadow-2xl">â„ï¸</span>
    </div>
    <p class="text-blue-200 text-xs tracking-[0.4em] font-black uppercase relative z-10">Harbin Memories</p>
</div>

    <!-- çª—å¤–é›ªèŠ± -->
    <canvas id="snowCanvas"></canvas>

    <!-- çª—æˆ¶å†°éœœ -->
    <canvas id="frostCanvas"></canvas>

    <!-- UI å±¤ -->
    <div class="ui-overlay">
        <button class="skip-btn" onclick="enterSite()">è·³éå‹•ç•« â”</button>
        
        <div class="hint-capsule">
            <h2 class="text-xl font-black mb-1 tracking-wider text-white">å“ˆçˆ¾æ¿±å›æ†¶éŒ„</h2>
            <p class="text-xs font-bold text-blue-300 tracking-[0.15em]">ç”¨æ‰‹æ“¦æ‹­é¡é¢ï¼Œæ’¥é–‹æ¼«å¤©å†°é›ª</p>
        </div>
    </div>

    <script>
        const fCanvas = document.getElementById('frostCanvas');
        const fCtx = fCanvas.getContext('2d');
        const sCanvas = document.getElementById('snowCanvas');
        const sCtx = sCanvas.getContext('2d');
        
        let isDrawing = false;
        let hasEntered = false;
        const threshold = 0.38; // ç¨å¾®é™ä½é–€æª»ï¼Œæ›´å¿«é€²å…¥

        // --- é›ªèŠ±å‹•ç•« ---
        let snowflakes = [];
        function initSnow() {
            sCanvas.width = window.innerWidth;
            sCanvas.height = window.innerHeight;
            snowflakes = Array.from({length: 60}, () => ({
                x: Math.random() * sCanvas.width,
                y: Math.random() * sCanvas.height,
                r: Math.random() * 2 + 1,
                v: Math.random() * 1.2 + 0.6,
                o: Math.random() * 0.6 + 0.3
            }));
        }
        function drawSnow() {
            sCtx.clearRect(0, 0, sCanvas.width, sCanvas.height);
            snowflakes.forEach(s => {
                s.y += s.v;
                s.x += Math.sin(s.y / 40) * 0.5;
                if (s.y > sCanvas.height) s.y = -10;
                sCtx.fillStyle = `rgba(255, 255, 255, ${s.o})`;
                sCtx.beginPath();
                sCtx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
                sCtx.fill();
            });
            requestAnimationFrame(drawSnow);
        }

        // --- å†°éœœæ¸²æŸ“ ---
        function initFrost() {
            fCanvas.width = window.innerWidth;
            fCanvas.height = window.innerHeight;

            const grad = fCtx.createRadialGradient(
                fCanvas.width/2, fCanvas.height/2, 0,
                fCanvas.width/2, fCanvas.height/2, fCanvas.width
            );
            grad.addColorStop(0, '#f8fafc'); 
            grad.addColorStop(1, '#94a3b8');
            fCtx.fillStyle = grad;
            fCtx.fillRect(0, 0, fCanvas.width, fCanvas.height);

            // éš¨æ©Ÿç´°å¾®å†°æ™¶
            fCtx.fillStyle = 'rgba(255,255,255,0.4)';
            for(let i=0; i<1000; i++) {
                fCtx.beginPath();
                fCtx.arc(Math.random()*fCanvas.width, Math.random()*fCanvas.height, Math.random()*1, 0, Math.PI*2);
                fCtx.fill();
            }
            fCtx.globalCompositeOperation = 'destination-out';
        }

        function scratch(x, y) {
            if (hasEntered) return;
            fCtx.lineWidth = 110; // å¢åŠ æ“¦æ‹­é¢ç©
            fCtx.lineCap = 'round';
            fCtx.lineJoin = 'round';
            fCtx.beginPath();
            fCtx.moveTo(x, y);
            fCtx.lineTo(x + 0.1, y + 0.1);
            fCtx.stroke();
            if (Math.random() > 0.85) checkProgress();
        }

        function checkProgress() {
            const data = fCtx.getImageData(0, 0, fCanvas.width, fCanvas.height).data;
            let cleared = 0;
            const step = 4 * 40; // å„ªåŒ–å–æ¨£
            for (let i = 3; i < data.length; i += step) {
                if (data[i] === 0) cleared++;
            }
            if (cleared / (data.length / step) > threshold) enterSite();
        }

        function enterSite() {
            if (hasEntered) return;
            hasEntered = true;
            document.body.classList.add('clearing');
            // âœ… ç¸®çŸ­è½‰å ´æ™‚é–“
            setTimeout(() => {
                window.location.href = 'home.html'; 
            }, 900); // ç¸®çŸ­ç‚º 0.6 ç§’
        }

        const getPos = (e) => ({
            x: e.touches ? e.touches[0].clientX : e.clientX,
            y: e.touches ? e.touches[0].clientY : e.clientY
        });
        const start = (e) => { isDrawing = true; const p = getPos(e); scratch(p.x, p.y); };
        const move = (e) => { if(isDrawing) { const p = getPos(e); scratch(p.x, p.y); } };
        const end = () => { isDrawing = false; };

        window.onload = () => {
            initSnow();
            drawSnow();
            initFrost();
        };
        window.onresize = () => { initSnow(); initFrost(); };

        fCanvas.addEventListener('mousedown', start);
        window.addEventListener('mousemove', move);
        window.addEventListener('mouseup', end);
        fCanvas.addEventListener('touchstart', start);
        window.addEventListener('touchmove', move);
        window.addEventListener('touchend', end);
    </script>

<div class="runner-track">
    <div class="runner"></div>
</div>


</body>
</html>